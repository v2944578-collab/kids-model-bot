import logging
from aiogram import Bot, Dispatcher, executor, types
from aiogram.types import InlineKeyboardMarkup, InlineKeyboardButton
import os

# ===== –ù–ê–°–¢–†–û–ô–ö–ò =====
BOT_TOKEN = os.getenv("BOT_TOKEN")
ADMIN_ID = int(os.getenv("ADMIN_ID", "0"))

logging.basicConfig(level=logging.INFO)

bot = Bot(token=BOT_TOKEN)
dp = Dispatcher(bot)

# ===== –ö–ù–û–ü–ö–ò –ú–ï–ù–Æ =====
def main_menu():
    kb = InlineKeyboardMarkup(row_width=1)
    kb.add(
        InlineKeyboardButton("üìå –ó–∞–ø–∏—Å–∞—Ç—å—Å—è –≤ –≥—Ä—É–ø–ø—É 6‚Äì9 –ª–µ—Ç", callback_data="group_6_9"),
        InlineKeyboardButton("üìå –ó–∞–ø–∏—Å–∞—Ç—å—Å—è –≤ –≥—Ä—É–ø–ø—É 10‚Äì14 –ª–µ—Ç", callback_data="group_10_14"),
        InlineKeyboardButton("üìÖ –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ", callback_data="schedule"),
        InlineKeyboardButton("üë©‚Äçüè´ –ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–∏", callback_data="teachers"),
        InlineKeyboardButton("‚ùì –ó–∞–¥–∞—Ç—å —Å–≤–æ–π –≤–æ–ø—Ä–æ—Å", callback_data="question"),
    )
    return kb

# ===== /START =====
@dp.message_handler(commands=["start"])
async def start(message: types.Message):
    await message.answer(
        "–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! üëã\n\n"
        "–í—ã –≤ –±–æ—Ç–µ –¥–µ—Ç—Å–∫–æ–≥–æ –º–æ–¥–µ–ª—å–Ω–æ–≥–æ –∞–≥–µ–Ω—Ç—Å—Ç–≤–∞.\n"
        "–í—ã–±–µ—Ä–∏—Ç–µ –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–∏–π —Ä–∞–∑–¥–µ–ª:",
        reply_markup=main_menu()
    )

# ===== –û–ë–†–ê–ë–û–¢–ö–ê –ö–ù–û–ü–û–ö =====
@dp.callback_query_handler(lambda c: c.data)
async def process_callback(callback_query: types.CallbackQuery):
    data = callback_query.data

    if data == "group_6_9":
        await callback_query.message.answer(
            "–ì—Ä—É–ø–ø–∞ 6‚Äì9 –ª–µ—Ç.\n\n"
            "–î–ª—è –∑–∞–ø–∏—Å–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –æ–ø–ª–∞—Ç–∏—Ç—å —É—á–∞—Å—Ç–∏–µ:\n"
            "üëâ https://pay.example.com/6-9"
        )

    elif data == "group_10_14":
        await callback_query.message.answer(
            "–ì—Ä—É–ø–ø–∞ 10‚Äì14 –ª–µ—Ç.\n\n"
            "–î–ª—è –∑–∞–ø–∏—Å–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –æ–ø–ª–∞—Ç–∏—Ç—å —É—á–∞—Å—Ç–∏–µ:\n"
            "üëâ https://pay.example.com/10-14"
        )

    elif data == "schedule":
        await callback_query.message.answer(
            "üìÖ –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –∑–∞–Ω—è—Ç–∏–π:\n"
            "–ü–Ω, –°—Ä ‚Äî 17:00\n"
            "–°–± ‚Äî 12:00"
        )

    elif data == "teachers":
        await callback_query.message.answer(
            "üë©‚Äçüè´ –ù–∞—à–∏ –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–∏:\n"
            "‚Ä¢ –ê–Ω–Ω–∞ –ò–≤–∞–Ω–æ–≤–∞ ‚Äî –¥–µ—Ñ–∏–ª–µ\n"
            "‚Ä¢ –ú–∞—Ä–∏—è –ü–µ—Ç—Ä–æ–≤–∞ ‚Äî —Ñ–æ—Ç–æ–ø–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ"
        )

    elif data == "question":
        await callback_query.message.answer(
            "‚úçÔ∏è –ù–∞–ø–∏—à–∏—Ç–µ –≤–∞—à –≤–æ–ø—Ä–æ—Å –≤ –æ—Ç–≤–µ—Ç–Ω–æ–º —Å–æ–æ–±—â–µ–Ω–∏–∏.\n"
            "–ú–µ–Ω–µ–¥–∂–µ—Ä –æ—Ç–≤–µ—Ç–∏—Ç –≤–∞–º –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è."
        )

    await callback_query.answer()

# ===== –ü–ï–†–ï–°–´–õ–ö–ê –í–û–ü–†–û–°–û–í –ú–ï–ù–ï–î–ñ–ï–†–£ =====
@dp.message_handler(lambda message: not message.text.startswith("/"))
async def forward_question(message: types.Message):
    if ADMIN_ID != 0:
        await bot.send_message(
            ADMIN_ID,
            f"‚ùì –í–æ–ø—Ä–æ—Å –æ—Ç @{message.from_user.username}:\n\n{message.text}"
        )
    await message.reply("–°–ø–∞—Å–∏–±–æ! –ú–µ–Ω–µ–¥–∂–µ—Ä –æ—Ç–≤–µ—Ç–∏—Ç –≤–∞–º üí¨")

# ===== –ó–ê–ü–£–°–ö =====
if name == "__main__":
    executor.start_polling(dp, skip_updates=True)
